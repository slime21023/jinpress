<!DOCTYPE html>
<html lang="{{ site.lang }}" data-theme="light">
<head>
    {% block head %}
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{% if page.title != site.title %}{{ page.title }} | {{ site.title }}{% else %}{{ site.title }}{% endif %}{% endblock %}</title>
    <meta name="description" content="{{ page.description or site.description }}">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="{{ '/assets/css/variables.css' | url_for(site.base) }}">
    <link rel="stylesheet" href="{{ '/assets/css/main.css' | url_for(site.base) }}">
    <link rel="stylesheet" href="{{ '/assets/css/highlight.css' | url_for(site.base) }}">
    
    <!-- Theme initialization -->
    <script>
        (function() {
            const theme = localStorage.getItem('jinpress-theme') || 
                (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
            document.documentElement.setAttribute('data-theme', theme);
        })();
    </script>
    {% endblock %}
</head>
<body class="{% block body_class %}{% endblock %}">
    <!-- Mobile Header -->
    <header class="mobile-header">
        <button id="sidebar-toggle" style="background:none;border:none;cursor:pointer;font-size:1.5rem;margin-right:1rem;"></button>
        <div class="logo">{{ site.title }}</div>
    </header>

    <div class="page-wrapper">
        <!-- Left Sidebar -->
        <aside class="sidebar-drawer">
            {% include "partials/sidebar.html" %}
        </aside>

        <!-- Main Content Area -->
        <div class="main-container">
            <main class="content">
                {% block content %}{% endblock %}
                
                {% include "partials/prev-next.html" %}
                {% include "partials/footer.html" %}
            </main>
        </div>

        <!-- Right TOC -->
        <aside class="toc-drawer">
            {% include "partials/toc.html" %}
        </aside>
    </div>

    <script src="{{ '/assets/js/main.js' | url_for(site.base) }}"></script>
    <script src="{{ '/assets/js/theme-toggle.js' | url_for(site.base) }}"></script>
    <script src="{{ '/assets/js/search.js' | url_for(site.base) }}"></script>
</body>
</html>
